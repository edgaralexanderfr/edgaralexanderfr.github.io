function deleteCookie(a){return!0===getCookie(a)?setCookie(a,void 0,0):setCookie(a,"",0)};function downloadFile(a,b,d,e){if("string"!=typeof a||"string"!=typeof b)throw"InvalidTypeError";if(isNaN(e)||0>e)e=100;if("function"==typeof navigator.msSaveBlob)return navigator.msSaveBlob(new Blob([d],{type:b},a));var c=document.createElement("a"),f=URL.createObjectURL(new Blob([d],{type:b}));c.href=f;c.download=a;c.style.display="none";document.body.appendChild(c);c.click();document.body.removeChild(c);setTimeout(function(){URL.revokeObjectURL(f)},Math.round(e))};function extend(a,b){a.prototype="function"==typeof Object.create?Object.create(b.prototype):new b;a.prototype.constructor=a};function getCookie(a){var b=document.cookie.split(";"),d=b.length,e,c;for(e=0;e<d;e++)if(c=b[e].split("=")," "==c[0][0]&&(c[0]=c[0].substring(1,c[0].length)),a==decodeURIComponent(c[0]))return 1<c.length?decodeURIComponent(c.splice(1,c.length).join("=")):!0;return""};function inArray(a,b){if("number"!=typeof a.length)return!1;var d=a.length,e;for(e=0;e<d;e++)if(b==a[e])return!0;return!1};function openLink(a,b){if("string"==typeof a){"string"!=typeof b&&(b="_blank");var d=document.createElement("a");d.target=b;d.href=a;d.click();d.href=""}};function removeFileNameExtension(a){var b=a.split(".");return 1<b.length?b.splice(0,b.length-1).join("."):a};function setCookie(a,b,d,e,c,f,g){if("undefined"==typeof a)return document.cookie;a=encodeURIComponent(a);"undefined"!=typeof b&&(a+="="+encodeURIComponent(b));"number"==typeof d&&(b=new Date,b.setTime(b.getTime()+Math.round(d)),a+="; expires="+b.toGMTString());"number"==typeof e&&(a+="; max-age="+Math.round(e));"string"==typeof c&&(a+="; path="+encodeURIComponent(c));"string"==typeof f&&(a+="; domain="+encodeURIComponent(f));"boolean"==typeof g&&g&&(a+="; secure");document.cookie=a;return document.cookie}
;function toElementLocalCoords(a,b,d){if(!(a instanceof HTMLElement)||isNaN(b)||isNaN(d))throw"InvalidTypeError";var e=a.getBoundingClientRect();return{x:(b-e.left)/(e.right-e.left)*a.width,y:(d-e.top)/(e.bottom-e.top)*a.height}};function Language(){this._languages={};this._name="";this._cache=!1;this._undefinedTextMessage="";this._domAttributeName="data-langTextName";this._domAttributeTarget="data-langTextTarget";this._cookieName="language";this._saveCookie=!1;this._cookieLifeTime=31536E6;this.onLoadError=this.onLoadComplete=null}Language.prototype.getLanguages=function(){return this._languages};Language.prototype.getName=function(){return this._name};Language.prototype.cacheEnabled=function(){return this._cache};
Language.prototype.getUndefinedTextMessage=function(){return this._undefinedTextMessage};Language.prototype.getDOMAttributeName=function(){return this._domAttributeName};Language.prototype.getDOMAttributeTarget=function(){return this._domAttributeTarget};Language.prototype.getCookieName=function(){return this._cookieName};Language.prototype.getCookieLifeTime=function(){return this._cookieLifeTime};
Language.prototype.setName=function(a){if("undefined"==typeof this._languages[a])throw"UndefinedLanguageError";this._name=a;this._saveCookie&&setCookie(this._cookieName,a,this._cookieLifeTime)};Language.prototype.setNameFromCookie=function(){try{this.setName(getCookie(this._cookieName))}catch(a){}};Language.prototype.enableCache=function(a){"boolean"==typeof a&&(this._cache=a)};Language.prototype.setCookieLifeTime=function(a){this._cookieLifeTime=a};
Language.prototype.setUndefinedTextMessage=function(a){"string"==typeof a&&(this._undefinedTextMessage=a)};Language.prototype.setDOMAttributeName=function(a){"string"==typeof a&&(this._domAttributeName=a)};Language.prototype.setDOMAttributeTarget=function(a){"string"==typeof a&&(this._domAttributeTarget=a)};Language.prototype.setCookieName=function(a){"string"==typeof a&&(this._cookieName=a)};Language.prototype.saveCookie=function(a){"boolean"==typeof a&&(this._saveCookie=a);return this._saveCookie};
Language.prototype.loadFromJSON=function(a,b,d,e){if("function"!=typeof $)throw"jQueryNotDefinedError";if("string"==typeof a&&"string"==typeof b){var c=this;$.ajax({dataType:"json",url:b,cache:this._cache,success:function(f){"undefined"==typeof f?e(a,b):(c._languages[a]=f,"function"==typeof d&&d())},error:function(){"function"==typeof e&&e(a,b)}})}};
Language.prototype.loadFromJSONList=function(a){if("function"!=typeof $)throw"jQueryNotDefinedError";if("number"!=typeof a.length)throw"InvalidTypeError";var b=this,d=0,e=a.length,c;for(c=0;c<e;c++)this.loadFromJSON(a[c].name,a[c].url,function(){d++;if(d==e&&"function"==typeof b.onLoadComplete)b.onLoadComplete()},this.onLoadError)};
Language.prototype.getText=function(a){return"undefined"!=typeof this._languages[this._name]&&"undefined"!=typeof this._languages[this._name][a]?this._languages[this._name][a]:this._undefinedTextMessage};
Language.prototype.translateDOM=function(a){if("object"!=typeof this._languages[this._name])throw"UndefinedLanguageError";"boolean"==typeof a&&a&&$("html").attr("lang",this._name);var b=this;$("["+this._domAttributeName+"]").each(function(){for(var a=1,e,c;"undefined"!=typeof(e=$(this).attr(b._domAttributeName+(c=1==a?"":a+"")));)a++,"undefined"!=typeof b._languages[b._name][e]&&(c=$(this).attr(b._domAttributeTarget+c),"undefined"!=typeof c?$(this).attr(c,b._languages[b._name][e]):$(this).html(b._languages[b._name][e]))})};
Language.prototype.loadDOMTextAsLanguage=function(a){if("string"!=typeof a)throw"InvalidTypeError";var b=this;this._languages[a]={};$("["+this._domAttributeName+"]").each(function(){for(var d=1,e,c;"undefined"!=typeof(e=$(this).attr(b._domAttributeName+(c=1==d?"":d+"")));)c=$(this).attr(b._domAttributeTarget+c),b._languages[a][e]="undefined"!=typeof c?$(this).attr(c):$(this).html(),d++})};
Language.prototype.saveAsJSONFile=function(){if("object"!=typeof this._languages[this._name])throw"UndefinedLanguageError";var a=(""==this._name?"language":this._name)+".json",b="{\n",d;for(d in this._languages[this._name])b+='  "'+d+'" : "'+this._languages[this._name][d].replace(/"/g,'\\"')+'", \n';b=b.substring(0,b.length-3)+"\n}";downloadFile(a,"application/json",b)};if("object"!=typeof Draw2PNG)var Draw2PNG={};Draw2PNG.Color=function(a,b,d,e){"undefined"!=typeof a?this.setRed(a):this._red=255;"undefined"!=typeof b?this.setGreen(b):this._green=255;"undefined"!=typeof d?this.setBlue(d):this._blue=255;"undefined"!=typeof e?this.setAlphaf(e):this._alpha=255};Draw2PNG.Color.prototype.getRed=function(){return this._red};Draw2PNG.Color.prototype.getGreen=function(){return this._green};Draw2PNG.Color.prototype.getBlue=function(){return this._blue};
Draw2PNG.Color.prototype.getAlpha=function(){return this._alpha};Draw2PNG.Color.prototype.getAlphaf=function(){return this._alpha/255};Draw2PNG.Color.prototype.setRed=function(a){if(isNaN(a)||0>a||255<a)throw"InvalidColorError";this._red=Math.round(a);return this};Draw2PNG.Color.prototype.setGreen=function(a){if(isNaN(a)||0>a||255<a)throw"InvalidColorError";this._green=Math.round(a);return this};
Draw2PNG.Color.prototype.setBlue=function(a){if(isNaN(a)||0>a||255<a)throw"InvalidColorError";this._blue=Math.round(a);return this};Draw2PNG.Color.prototype.setAlpha=function(a){if(isNaN(a)||0>a||255<a)throw"InvalidColorError";this._alpha=Math.round(a);return this};Draw2PNG.Color.prototype.setAlphaf=function(a){if(isNaN(a)||0>a||1<a)throw"InvalidColorError";this._alpha=Math.round(255*a);return this};
Draw2PNG.Color.prototype.setRGBAf=function(a,b,d,e){this.setRed(a);this.setGreen(b);this.setBlue(d);this.setAlphaf(e);return this};Draw2PNG.Color.prototype.setRGBAfObject=function(a){return this.setRGBAf(a.r,a.g,a.b,a.a)};Draw2PNG.Color.prototype.toHex24=function(){var a=this._red.toString(16),b=this._green.toString(16),d=this._blue.toString(16);return"#"+(16>this._red?"0"+a:a)+(16>this._green?"0"+b:b)+(16>this._blue?"0"+d:d)};"object"!=typeof Draw2PNG&&(Draw2PNG={});
Draw2PNG.Pixmap=function(a){this._canvas=a instanceof HTMLCanvasElement?a:document.createElement("canvas");this._canvas.style.width=this._canvas.width+"px";this._canvas.style.height=this._canvas.height+"px";this._context=this._canvas.getContext("2d");this._image=this._data=null;this._zoom=1;this._minZoom=this._zoomDelta=.1;this._maxZoom=2;this._supportedTypes=["image/png","image/jpeg","image/svg+xml","image/gif","image/bmp"];this.onFileReadError=this.onImageLoadComplete=this.onImageLoadError=this._file=
this._fileReader=null};Draw2PNG.Pixmap.prototype.getCanvas=function(){return this._canvas};Draw2PNG.Pixmap.prototype.getContext=function(){return this._context};Draw2PNG.Pixmap.prototype.getData=function(){return this._data instanceof ImageData?this._data:this._data=this._context.getImageData(0,0,this._canvas.width,this._canvas.height)};Draw2PNG.Pixmap.prototype.getImage=function(){return this._image instanceof HTMLImageElement?this._image:this._image=new Image};
Draw2PNG.Pixmap.prototype.getZoom=function(){return this._zoom};Draw2PNG.Pixmap.prototype.getZoomDelta=function(){return this._zoomDelta};Draw2PNG.Pixmap.prototype.getMinZoom=function(){return this._minZoom};Draw2PNG.Pixmap.prototype.getMaxZoom=function(){return this._maxZoom};Draw2PNG.Pixmap.prototype.getSupportedTypes=function(){return this._supportedTypes};Draw2PNG.Pixmap.prototype.getFileReader=function(){return this._fileReader instanceof FileReader?this._fileReader:this._fileReader=new FileReader};
Draw2PNG.Pixmap.prototype.getFile=function(){return this._file};Draw2PNG.Pixmap.prototype.getFileName=function(){return null!=this._file?this._file.name:""};Draw2PNG.Pixmap.prototype.getFileNameWithoutExtension=function(){return removeFileNameExtension(this.getFileName())};Draw2PNG.Pixmap.prototype.setZoom=function(a){isNaN(a)||(this._zoom=a<this._minZoom?this._minZoom:a>this._maxZoom?this._maxZoom:a,this.scaleToZoom())};
Draw2PNG.Pixmap.prototype.setZoomDelta=function(a){!isNaN(a)&&0<=a&&(this._zoomDelta=a)};Draw2PNG.Pixmap.prototype.setMinZoom=function(a){!isNaN(a)&&0<a&&a<=this._maxZoom&&(this._minZoom=a)};Draw2PNG.Pixmap.prototype.setMaxZoom=function(a){!isNaN(a)&&0<a&&a>=this._minZoom&&(this._maxZoom=a)};Draw2PNG.Pixmap.prototype.zoomIn=function(){this.setZoom(this._zoom+this._zoomDelta)};Draw2PNG.Pixmap.prototype.zoomOut=function(){this.setZoom(this._zoom-this._zoomDelta)};
Draw2PNG.Pixmap.prototype.scaleToZoom=function(){this._canvas.style.width=Math.round(this._canvas.width*this._zoom)+"px";this._canvas.style.height=Math.round(this._canvas.height*this._zoom)+"px"};Draw2PNG.Pixmap.prototype.setSupportedTypes=function(a){"object"==typeof a&&(this._supportedTypes=a)};
Draw2PNG.Pixmap.prototype.clear=function(a,b){this.disposeData();this._context.clearRect(0,0,this._canvas.width,this._canvas.height);"number"==typeof a&&(this._canvas.width=a);"number"==typeof b&&(this._canvas.height=b)};Draw2PNG.Pixmap.prototype.setImage=function(a){if(!(a instanceof HTMLImageElement))throw"InvalidTypeError";this._image=a;this.clear(this._image.width,this._image.height);this.setZoom(1);this._context.drawImage(this._image,0,0,this._image.width,this._image.height)};
Draw2PNG.Pixmap.prototype.setImageFromURL=function(a){if("string"!=typeof a){if("function"==typeof this.onImageLoadError)this.onImageLoadError("InvalidTypeError")}else{var b=this,d=this.getImage();d.onload=function(a){try{if(b.setImage(d),"function"==typeof b.onImageLoadComplete)b.onImageLoadComplete()}catch(c){if("function"==typeof b.onImageLoadError)b.onImageLoadError(c)}};d.onerror=function(a){if("function"==typeof b.onImageLoadError)b.onImageLoadError("ImageNotLoadedError")};d.src=a}};
Draw2PNG.Pixmap.prototype.loadFromFile=function(a){if(!(a instanceof File)){if("function"==typeof this.onFileReadError)this.onFileReadError("InvalidTypeError")}else if(this.hasSupportedType(a)){var b=this,d=this.getFileReader();d.onerror=function(a){if("function"==typeof b.onFileReadError)b.onFileReadError("FileReadError")};d.onloadend=function(e){var c=b.onImageLoadComplete;b.onImageLoadComplete=function(){b.onImageLoadComplete=c;b._file=a;if("function"==typeof b.onImageLoadComplete)b.onImageLoadComplete()};
b.setImageFromURL(d.result)};d.readAsDataURL(a)}else if("function"==typeof this.onFileReadError)this.onFileReadError("InvalidImageTypeError")};Draw2PNG.Pixmap.prototype.loadFirstFromFileList=function(a){if(a instanceof FileList)if(0==a.length){if("function"==typeof this.onFileReadError)this.onFileReadError("NoFileProvidedError")}else this.loadFromFile(a[0]);else if("function"==typeof this.onFileReadError)this.onFileReadError("InvalidTypeError")};
Draw2PNG.Pixmap.prototype.getPixel=function(a,b){if(isNaN(a)||isNaN(b)||0>a||a>=this._canvas.width||0>b||b>=this._canvas.height)throw"InvalidPixelCoordError";var d=this.getData(),e=4*(Math.round(a)+Math.round(b)*this._canvas.width),c=new Draw2PNG.Color;c.setRed(d.data[e]);c.setGreen(d.data[e+1]);c.setBlue(d.data[e+2]);c.setAlpha(d.data[e+3]);return c};
Draw2PNG.Pixmap.prototype.getPixelWithoutCanvasOffset=function(a,b){var d=toElementLocalCoords(this._canvas,a,b);return this.getPixel(Math.floor(d.x),Math.floor(d.y))};Draw2PNG.Pixmap.prototype.hasSupportedType=function(a){return a instanceof File?inArray(this._supportedTypes,a.type):!1};Draw2PNG.Pixmap.prototype.disposeData=function(){this._data=null};Draw2PNG.Pixmap.prototype.disposeImage=function(){this._image=null};Draw2PNG.Pixmap.prototype.disposeFileReader=function(){this._fileReader=null};
Draw2PNG.Pixmap.prototype.dispose=function(){this.disposeData();this.disposeImage();this.disposeFileReader()};"object"!=typeof Draw2PNG&&(Draw2PNG={});Draw2PNG.Filter=function(a,b){this._originalPixmap=a instanceof Draw2PNG.Pixmap?a:new Draw2PNG.Pixmap(a);this._outputPixmap=b instanceof Draw2PNG.Pixmap?b:new Draw2PNG.Pixmap(b);this.onLoadComplete=this.onLoadError=null};Draw2PNG.Filter.prototype.getOriginalPixmap=function(){return this._originalPixmap};Draw2PNG.Filter.prototype.getOutputPixmap=function(){return this._outputPixmap};
Draw2PNG.Filter.prototype.openFromFile=function(a){this._originalPixmap.onFileReadError=this._originalPixmap.onImageLoadError=this.onLoadError;this._originalPixmap.onImageLoadComplete=this.onLoadComplete;this._originalPixmap.loadFromFile(a)};Draw2PNG.Filter.prototype.openFirstFromFileList=function(a){this._originalPixmap.onFileReadError=this._originalPixmap.onImageLoadError=this.onLoadError;this._originalPixmap.onImageLoadComplete=this.onLoadComplete;this._originalPixmap.loadFirstFromFileList(a)};
Draw2PNG.Filter.prototype.dispose=function(){this._originalPixmap.dispose();this._outputPixmap.dispose()};"object"!=typeof Draw2PNG&&(Draw2PNG={});Draw2PNG.ColorToleranceFilter=function(a,b){Draw2PNG.Filter.apply(this,[a,b]);this._maxToleratedColor=new Draw2PNG.Color(128,128,128,1);this._outputColor=new Draw2PNG.Color(0,0,0,1);this._backgroundColor=new Draw2PNG.Color(255,255,255,0);this._outputColorAllowed=!0;this._brightness=0};extend(Draw2PNG.ColorToleranceFilter,Draw2PNG.Filter);Draw2PNG.ColorToleranceFilter.prototype.getMaxToleratedColor=function(){return this._maxToleratedColor};
Draw2PNG.ColorToleranceFilter.prototype.getOutputColor=function(){return this._outputColor};Draw2PNG.ColorToleranceFilter.prototype.getBackgroundColor=function(){return this._backgroundColor};Draw2PNG.ColorToleranceFilter.prototype.isOutputColorAllowed=function(){return this._outputColorAllowed};Draw2PNG.ColorToleranceFilter.prototype.getBrightness=function(){return this._brightness};
Draw2PNG.ColorToleranceFilter.prototype.setMaxToleratedColor=function(a){a instanceof Draw2PNG.Color&&(this._maxToleratedColor=a)};Draw2PNG.ColorToleranceFilter.prototype.setOutputColor=function(a){a instanceof Draw2PNG.Color&&(this._outputColor=a)};Draw2PNG.ColorToleranceFilter.prototype.setBackgroundColor=function(a){a instanceof Draw2PNG.Color&&(this._backgroundColor=a)};Draw2PNG.ColorToleranceFilter.prototype.allowOutputColor=function(a){this._outputColorAllowed="boolean"==typeof a&&a?a:!1};
Draw2PNG.ColorToleranceFilter.prototype.setBrightness=function(a){"number"==typeof a&&-1<=a&&1>=a&&(this._brightness=a)};Draw2PNG.ColorToleranceFilter.prototype.setBrightnessPercentage=function(a){"number"==typeof a&&-100<=a&&100>=a&&(this._brightness=a/100)};
Draw2PNG.ColorToleranceFilter.prototype.apply=function(){this._outputPixmap.clear(this._originalPixmap.getCanvas().width,this._originalPixmap.getCanvas().height);var a=this._originalPixmap.getData(),b=this._outputPixmap.getData(),d=a.data.length,e,c,f,g,h;for(e=0;e<d;e+=4)c=e,f=e+1,g=e+2,h=e+3,a.data[c]<=this._maxToleratedColor.getRed()&&a.data[f]<=this._maxToleratedColor.getGreen()&&a.data[g]<=this._maxToleratedColor.getBlue()?this._outputColorAllowed?(b.data[c]=this._outputColor.getRed(),b.data[f]=
this._outputColor.getGreen(),b.data[g]=this._outputColor.getBlue(),b.data[h]=this._outputColor.getAlpha()):(b.data[c]=a.data[c],b.data[f]=a.data[f],b.data[g]=a.data[g],b.data[h]=a.data[h]):(b.data[c]=this._backgroundColor.getRed(),b.data[f]=this._backgroundColor.getGreen(),b.data[g]=this._backgroundColor.getBlue(),b.data[h]=this._backgroundColor.getAlpha()),0>this._brightness?(b.data[c]+=Math.round(this._brightness*b.data[c]),b.data[f]+=Math.round(this._brightness*b.data[f]),b.data[g]+=Math.round(this._brightness*
b.data[g])):(b.data[c]+=Math.round(this._brightness*(255-b.data[c])),b.data[f]+=Math.round(this._brightness*(255-b.data[f])),b.data[g]+=Math.round(this._brightness*(255-b.data[g])));this._outputPixmap.getContext().putImageData(b,0,0)};
